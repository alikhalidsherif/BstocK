Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\alikh> cd .\Documents\Dev\BstocK\
PS C:\Users\alikh\Documents\Dev\BstocK> docker compose up
time="2025-07-28T12:12:39+03:00" level=warning msg="C:\\Users\\alikh\\Documents\\Dev\\BstocK\\docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
[+] Running 1/1
 âœ” Container bstock-backend-1  Recreated                                                                           0.2s
Attaching to backend-1, db-1
db-1       |
db-1       | PostgreSQL Database directory appears to contain a database; Skipping initialization
db-1       |
db-1       | 2025-07-28 09:12:40.705 UTC [1] LOG:  starting PostgreSQL 15.13 (Debian 15.13-1.pgdg120+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
db-1       | 2025-07-28 09:12:40.705 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db-1       | 2025-07-28 09:12:40.705 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db-1       | 2025-07-28 09:12:40.710 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db-1       | 2025-07-28 09:12:40.722 UTC [29] LOG:  database system was shut down at 2025-07-28 09:12:35 UTC
db-1       | 2025-07-28 09:12:40.733 UTC [1] LOG:  database system is ready to accept connections
backend-1  | INFO:     Will watch for changes in these directories: ['/app']
backend-1  | INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
backend-1  | INFO:     Started reloader process [1] using StatReload
backend-1  | /usr/local/lib/python3.11/site-packages/pydantic/_internal/_config.py:373: UserWarning: Valid config keys have changed in V2:
backend-1  | * 'orm_mode' has been renamed to 'from_attributes'
backend-1  |   warnings.warn(message, UserWarning)
backend-1  | INFO:     Started server process [8]
backend-1  | INFO:     Waiting for application startup.
backend-1  | INFO:     Application startup complete.
backend-1  | INFO:     172.18.0.1:60970 - "POST /api/token HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60970 - "OPTIONS /api/users/me/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60986 - "GET /api/users/me/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60970 - "OPTIONS /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60986 - "OPTIONS /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60992 - "OPTIONS /api/products/categories HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60996 - "OPTIONS /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:32774 - "OPTIONS /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60970 - "GET /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:60992 - "GET /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:32774 - "GET /api/products/categories HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:32782 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:32782 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:49212 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:49228 - "GET /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:41040 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:41042 - "OPTIONS /api/inventory/request HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:41042 - "POST /api/inventory/request HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:41042 - "OPTIONS /api/inventory/requests/pending HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:41046 - "GET /api/inventory/requests/pending HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:41042 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:36144 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:36158 - "GET /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:36144 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43752 - "GET /api/users/me/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43770 - "GET /api/products/categories HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43756 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43768 - "GET /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43756 - "GET /api/products/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43768 - "GET /api/history/ HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43768 - "GET /api/inventory/requests/pending HTTP/1.1" 200 OK
backend-1  | INFO:     172.18.0.1:43768 - "OPTIONS /api/inventory/requests/3/approve HTTP/1.1" 200 OK
db-1       | 2025-07-28 09:17:31.449 UTC [41] ERROR:  insert or update on table "change_history" violates foreign key constraint "change_history_product_id_fkey"
db-1       | 2025-07-28 09:17:31.449 UTC [41] DETAIL:  Key (product_id)=(1) is not present in table "products".
backend-1  | INFO:     172.18.0.1:43756 - "PUT /api/inventory/requests/3/approve HTTP/1.1" 500 Internal Server Error
db-1       | 2025-07-28 09:17:31.449 UTC [41] STATEMENT:  INSERT INTO change_history (product_id, quantity_change, action, status, requester_id, reviewer_id, timestamp, buyer_name, payment_status) VALUES (1, NULL, 'delete', 'approved', 1, 1, '2025-07-28T09:17:31.438948'::timestamp, NULL, NULL) RETURNING change_history.id
backend-1  | ERROR:    Exception in ASGI application
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
backend-1  |     self.dialect.do_execute(
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
backend-1  |     cursor.execute(statement, parameters)
backend-1  | psycopg2.errors.ForeignKeyViolation: insert or update on table "change_history" violates foreign key constraint "change_history_product_id_fkey"
backend-1  | DETAIL:  Key (product_id)=(1) is not present in table "products".
backend-1  |
backend-1  |
backend-1  | The above exception was the direct cause of the following exception:
backend-1  |
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
backend-1  |     result = await app(  # type: ignore[func-returns-value]
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
backend-1  |     return await self.app(scope, receive, send)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
backend-1  |     await super().__call__(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
backend-1  |     await self.app(scope, receive, _send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
backend-1  |     await self.simple_response(scope, receive, send, request_headers=headers)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
backend-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
backend-1  |     await route.handle(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
backend-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
backend-1  |     response = await f(request)
backend-1  |                ^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
backend-1  |     raw_response = await run_endpoint_function(
backend-1  |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 215, in run_endpoint_function
backend-1  |     return await run_in_threadpool(dependant.call, **values)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
backend-1  |     return await anyio.to_thread.run_sync(func)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
backend-1  |     return await get_async_backend().run_sync_in_worker_thread(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
backend-1  |     return await future
backend-1  |            ^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 967, in run
backend-1  |     result = context.run(func, *args)
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/routers/inventory.py", line 70, in approve_request
backend-1  |     approved_request = crud.approve_change_request(db, request_id=request_id, reviewer_id=current_user.id)
backend-1  |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/crud.py", line 148, in approve_change_request
backend-1  |     db.commit()
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
backend-1  |     trans.commit(_to_root=True)
backend-1  |   File "<string>", line 2, in commit
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
backend-1  |     ret_value = fn(self, *arg, **kw)
backend-1  |                 ^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
backend-1  |     self._prepare_impl()
backend-1  |   File "<string>", line 2, in _prepare_impl
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
backend-1  |     ret_value = fn(self, *arg, **kw)
backend-1  |                 ^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
backend-1  |     self.session.flush()
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
backend-1  |     self._flush(objects)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
backend-1  |     with util.safe_reraise():
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
backend-1  |     raise exc_value.with_traceback(exc_tb)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
backend-1  |     flush_context.execute()
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
backend-1  |     rec.execute(self)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
backend-1  |     util.preloaded.orm_persistence.save_obj(
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
backend-1  |     _emit_insert_statements(
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 1227, in _emit_insert_statements
backend-1  |     result = connection.execute(
backend-1  |              ^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
backend-1  |     return meth(
backend-1  |            ^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 517, in _execute_on_connection
backend-1  |     return connection._execute_clauseelement(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
backend-1  |     ret = self._execute_context(
backend-1  |           ^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
backend-1  |     return self._exec_single_context(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
backend-1  |     self._handle_dbapi_exception(
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
backend-1  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
backend-1  |     self.dialect.do_execute(
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
backend-1  |     cursor.execute(statement, parameters)
backend-1  | sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "change_history" violates foreign key constraint "change_history_product_id_fkey"
backend-1  | DETAIL:  Key (product_id)=(1) is not present in table "products".
backend-1  |
backend-1  | [SQL: INSERT INTO change_history (product_id, quantity_change, action, status, requester_id, reviewer_id, timestamp, buyer_name, payment_status) VALUES (%(product_id)s, %(quantity_change)s, %(action)s, %(status)s, %(requester_id)s, %(reviewer_id)s, %(timestamp)s, %(buyer_name)s, %(payment_status)s) RETURNING change_history.id]
backend-1  | [parameters: {'product_id': 1, 'quantity_change': None, 'action': 'delete', 'status': 'approved', 'requester_id': 1, 'reviewer_id': 1, 'timestamp': datetime.datetime(2025, 7, 28, 9, 17, 31, 438948), 'buyer_name': None, 'payment_status': None}]
backend-1  | (Background on this error at: https://sqlalche.me/e/20/gkpj)
backend-1  | INFO:     172.18.0.1:43768 - "PUT /api/inventory/requests/3/approve HTTP/1.1" 500 Internal Server Error
backend-1  | ERROR:    Exception in ASGI application
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3494, in delete
backend-1  |     state = attributes.instance_state(instance)
backend-1  |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  | AttributeError: 'NoneType' object has no attribute '_sa_instance_state'
backend-1  |
backend-1  | The above exception was the direct cause of the following exception:
backend-1  |
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
backend-1  |     result = await app(  # type: ignore[func-returns-value]
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
backend-1  |     return await self.app(scope, receive, send)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
backend-1  |     await super().__call__(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
backend-1  |     await self.app(scope, receive, _send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
backend-1  |     await self.simple_response(scope, receive, send, request_headers=headers)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
backend-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
backend-1  |     await route.handle(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
backend-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
backend-1  |     response = await f(request)
backend-1  |                ^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
backend-1  |     raw_response = await run_endpoint_function(
backend-1  |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 215, in run_endpoint_function
backend-1  |     return await run_in_threadpool(dependant.call, **values)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
backend-1  |     return await anyio.to_thread.run_sync(func)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
backend-1  |     return await get_async_backend().run_sync_in_worker_thread(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
backend-1  |     return await future
backend-1  |            ^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 967, in run
backend-1  |     result = context.run(func, *args)
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/routers/inventory.py", line 70, in approve_request
backend-1  |     approved_request = crud.approve_change_request(db, request_id=request_id, reviewer_id=current_user.id)
backend-1  |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/crud.py", line 125, in approve_change_request
backend-1  |     delete_product(db, db_product)
backend-1  |   File "/app/app/crud.py", line 63, in delete_product
backend-1  |     db.delete(product)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3496, in delete
backend-1  |     raise exc.UnmappedInstanceError(instance) from err
backend-1  | sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
backend-1  | INFO:     172.18.0.1:55302 - "PUT /api/inventory/requests/3/approve HTTP/1.1" 500 Internal Server Error
backend-1  | ERROR:    Exception in ASGI application
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3494, in delete
backend-1  |     state = attributes.instance_state(instance)
backend-1  |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  | AttributeError: 'NoneType' object has no attribute '_sa_instance_state'
backend-1  |
backend-1  | The above exception was the direct cause of the following exception:
backend-1  |
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
backend-1  |     result = await app(  # type: ignore[func-returns-value]
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
backend-1  |     return await self.app(scope, receive, send)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
backend-1  |     await super().__call__(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
backend-1  |     await self.app(scope, receive, _send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
backend-1  |     await self.simple_response(scope, receive, send, request_headers=headers)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
backend-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
backend-1  |     await route.handle(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
backend-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
backend-1  |     response = await f(request)
backend-1  |                ^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
backend-1  |     raw_response = await run_endpoint_function(
backend-1  |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 215, in run_endpoint_function
backend-1  |     return await run_in_threadpool(dependant.call, **values)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
backend-1  |     return await anyio.to_thread.run_sync(func)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
backend-1  |     return await get_async_backend().run_sync_in_worker_thread(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
backend-1  |     return await future
backend-1  |            ^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 967, in run
backend-1  |     result = context.run(func, *args)
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/routers/inventory.py", line 70, in approve_request
backend-1  |     approved_request = crud.approve_change_request(db, request_id=request_id, reviewer_id=current_user.id)
backend-1  |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/crud.py", line 125, in approve_change_request
backend-1  |     delete_product(db, db_product)
backend-1  |   File "/app/app/crud.py", line 63, in delete_product
backend-1  |     db.delete(product)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3496, in delete
backend-1  |     raise exc.UnmappedInstanceError(instance) from err
backend-1  | sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
backend-1  | INFO:     172.18.0.1:55314 - "PUT /api/inventory/requests/3/approve HTTP/1.1" 500 Internal Server Error
backend-1  | ERROR:    Exception in ASGI application
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3494, in delete
backend-1  |     state = attributes.instance_state(instance)
backend-1  |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  | AttributeError: 'NoneType' object has no attribute '_sa_instance_state'
backend-1  |
backend-1  | The above exception was the direct cause of the following exception:
backend-1  |
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
backend-1  |     result = await app(  # type: ignore[func-returns-value]
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
backend-1  |     return await self.app(scope, receive, send)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
backend-1  |     await super().__call__(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
backend-1  |     await self.app(scope, receive, _send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
backend-1  |     await self.simple_response(scope, receive, send, request_headers=headers)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
backend-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
backend-1  |     await route.handle(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
backend-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
backend-1  |     response = await f(request)
backend-1  |                ^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
backend-1  |     raw_response = await run_endpoint_function(
backend-1  |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 215, in run_endpoint_function
backend-1  |     return await run_in_threadpool(dependant.call, **values)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
backend-1  |     return await anyio.to_thread.run_sync(func)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
backend-1  |     return await get_async_backend().run_sync_in_worker_thread(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
backend-1  |     return await future
backend-1  |            ^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 967, in run
backend-1  |     result = context.run(func, *args)
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/routers/inventory.py", line 70, in approve_request
backend-1  |     approved_request = crud.approve_change_request(db, request_id=request_id, reviewer_id=current_user.id)
backend-1  |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/crud.py", line 125, in approve_change_request
backend-1  |     delete_product(db, db_product)
backend-1  |   File "/app/app/crud.py", line 63, in delete_product
backend-1  |     db.delete(product)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3496, in delete
backend-1  |     raise exc.UnmappedInstanceError(instance) from err
backend-1  | sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
backend-1  | INFO:     172.18.0.1:55320 - "PUT /api/inventory/requests/3/approve HTTP/1.1" 500 Internal Server Error
backend-1  | ERROR:    Exception in ASGI application
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3494, in delete
backend-1  |     state = attributes.instance_state(instance)
backend-1  |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  | AttributeError: 'NoneType' object has no attribute '_sa_instance_state'
backend-1  |
backend-1  | The above exception was the direct cause of the following exception:
backend-1  |
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
backend-1  |     result = await app(  # type: ignore[func-returns-value]
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
backend-1  |     return await self.app(scope, receive, send)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
backend-1  |     await super().__call__(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
backend-1  |     await self.app(scope, receive, _send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
backend-1  |     await self.simple_response(scope, receive, send, request_headers=headers)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
backend-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
backend-1  |     await route.handle(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
backend-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
backend-1  |     response = await f(request)
backend-1  |                ^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
backend-1  |     raw_response = await run_endpoint_function(
backend-1  |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 215, in run_endpoint_function
backend-1  |     return await run_in_threadpool(dependant.call, **values)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
backend-1  |     return await anyio.to_thread.run_sync(func)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
backend-1  |     return await get_async_backend().run_sync_in_worker_thread(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
backend-1  |     return await future
backend-1  |            ^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 967, in run
backend-1  |     result = context.run(func, *args)
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/routers/inventory.py", line 70, in approve_request
backend-1  |     approved_request = crud.approve_change_request(db, request_id=request_id, reviewer_id=current_user.id)
backend-1  |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/crud.py", line 125, in approve_change_request
backend-1  |     delete_product(db, db_product)
backend-1  |   File "/app/app/crud.py", line 63, in delete_product
backend-1  |     db.delete(product)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3496, in delete
backend-1  |     raise exc.UnmappedInstanceError(instance) from err
backend-1  | sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
backend-1  | INFO:     172.18.0.1:55328 - "PUT /api/inventory/requests/3/approve HTTP/1.1" 500 Internal Server Error
backend-1  | ERROR:    Exception in ASGI application
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3494, in delete
backend-1  |     state = attributes.instance_state(instance)
backend-1  |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  | AttributeError: 'NoneType' object has no attribute '_sa_instance_state'
backend-1  |
backend-1  | The above exception was the direct cause of the following exception:
backend-1  |
backend-1  | Traceback (most recent call last):
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 412, in run_asgi
backend-1  |     result = await app(  # type: ignore[func-returns-value]
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
backend-1  |     return await self.app(scope, receive, send)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
backend-1  |     await super().__call__(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
backend-1  |     await self.app(scope, receive, _send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
backend-1  |     await self.simple_response(scope, receive, send, request_headers=headers)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
backend-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
backend-1  |     await self.middleware_stack(scope, receive, send)
db-1       | 2025-07-28 09:17:40.733 UTC [27] LOG:  checkpoint starting: time
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
backend-1  |     await route.handle(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
backend-1  |     await self.app(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
backend-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
backend-1  |     raise exc
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
backend-1  |     await app(scope, receive, sender)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
backend-1  |     response = await f(request)
backend-1  |                ^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
backend-1  |     raw_response = await run_endpoint_function(
backend-1  |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 215, in run_endpoint_function
backend-1  |     return await run_in_threadpool(dependant.call, **values)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool
backend-1  |     return await anyio.to_thread.run_sync(func)
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
backend-1  |     return await get_async_backend().run_sync_in_worker_thread(
backend-1  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
backend-1  |     return await future
backend-1  |            ^^^^^^^^^^^^
backend-1  |   File "/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 967, in run
backend-1  |     result = context.run(func, *args)
backend-1  |              ^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/routers/inventory.py", line 70, in approve_request
backend-1  |     approved_request = crud.approve_change_request(db, request_id=request_id, reviewer_id=current_user.id)
backend-1  |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1  |   File "/app/app/crud.py", line 125, in approve_change_request
backend-1  |     delete_product(db, db_product)
backend-1  |   File "/app/app/crud.py", line 63, in delete_product
backend-1  |     db.delete(product)
backend-1  |   File "/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3496, in delete
backend-1  |     raise exc.UnmappedInstanceError(instance) from err
backend-1  | sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.NoneType' is not mapped
db-1       | 2025-07-28 09:17:42.007 UTC [27] LOG:  checkpoint complete: wrote 15 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.231 s, sync=0.012 s, total=1.277 s; sync files=14, longest=0.003 s, average=0.001 s; distance=2 kB, estimate=2 kB


v View in Docker Desktop   o View Config   w Enable Watch
